/*! protocol - v2.0.1 - 2014-03-11 */ClientProtocol=function(){var e={},t=function(e,t){switch(t){case"string":e=$.parseJSON(e);break;case"json":break;default:}return e},r=function(){},a=function(e){var t={};return t.dataType=e.dataType,t.scope=e.scope||t,t.failure=e.failure,t.complete=e.complete,t.resultWrapper=e.resultWrapper,t.beforeUrl=e.beforeUrl,t.callName=e.callName,$.isFunction(t.resultWrapper)||(t.resultWrapper=function(e){return e.data=e.result.data,e.result.data={},e}),t},s=function(e,r){r[e.callName]=function(r){logger.log("hexinAjax请求返回结果："+r);var a="success";try{r=t(r,e.dataType),$.isFunction(e.resultWrapper)&&(r=e.resultWrapper(r)),r.status="success"}catch(s){r=s,r.status="error",a="error"}"success"===a?($.isFunction(e.afterSuccess)&&e.afterSuccess.call(e.scope,e,r,a),$.isFunction(e.success)&&e.success.call(e.scope,e,r,a)):(a="error",$.isFunction(e.failure)&&e.failure.call(e.scope,e,r,a)),$.isFunction(e.complete)&&e.complete.call(e.scope,e,a)}},c=function(e,t,r){var a=r.length,s=null;return 0==a?s=e[t]():1==a?s=e[t](r[0]):2==a?s=e[t](r[0],r[1]):3==a?s=e[t](r[0],r[1],r[2]):4==a&&(s=e[t](r[0],r[1],r[2],r[3])),s},n=function(t){var r=e[t.external];r||(r=external.createObject(t.external),e[t.external]=r);var a=[];t.parameter&&($.isArray(t.parameter)?a=t.parameter:a[0]=t.parameter),t.callName&&s(t,a[0]),$.isEmptyObject(t.beforeUrl)||(logger.log("调用前置beforeUrl："+t.external+"."+t.beforeUrl),c(r,t.beforeUrl,a)),logger.log("调用url："+t.external+"."+t.url);var n=c(r,t.url,a);return n},o=function(){},l=function(e){var t={};return t.type=e.type,t.dataType=e.dataType,t.callName=e.callName,t.failure=e.failure,t.complete=e.complete,t.resultWrapper=e.resultWrapper,t.scope=e.scope,$.isFunction(t.resultWrapper)||(t.resultWrapper=function(e){return $.isEmptyObject(e)?{}:(e.data=e.result,e.result={},e)}),t},p=function(t){var r=e[t.external];r||(r=external.createObject(t.external),e[t.external]=r);var a=t.url||"";"&"==a[a.length-1]&&(a=a.substr(0,a.length-1));var c=[],n=null;"GET"==t.type?($.each(t.parameter,function(e,t){c.push(e,"=",t,"&")}),c.length&&c.pop(),0>a.indexOf("?")&&c.length>0&&c.unshift("?"),a+=c.join("")):"POST"==t.type&&($.each(t.parameter,function(e,t){$.isEmptyObject(t)||c.push(e,"=",t,"&")}),c.length&&c.pop(),n=c.join("")),t.callName="onready",s(t,t),logger.log("hexinAjax请求发送：("+a+"), 参数("+n+")");var o=r.request({onready:t[t.callName],url:a,type:49,post:n});return o};Protocol.registerRequest("hexinAjax",{type:"hexinAjax",getOptions:l,validateOptions:o,request:p,registerEvent:null}),Protocol.registerRequest("client",{type:"client",getOptions:a,validateOptions:r,request:n,registerEvent:null})}();
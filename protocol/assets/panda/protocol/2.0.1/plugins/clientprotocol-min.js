/*! protocol - v2.0.1 - 2015-07-13 */ClientProtocol=function(){var a={},b=function(a,b){switch(b){case"string":a=$.parseJSON(a);break;case"json":}return a},c=function(a){},d=function(a){var b={};return b.dataType=a.dataType,b.scope=a.scope||b,b.failure=a.failure,b.complete=a.complete,b.resultWrapper=a.resultWrapper,b.beforeUrl=a.beforeUrl,b.callName=a.callName,$.isFunction(b.resultWrapper)||(b.resultWrapper=function(a){return a.data=a.result.data,a.result.data={},a}),b},e=function(a,c){c[a.callName]=function(c){logger.log("hexinAjax请求返回结果："+c);var d="success";try{c=b(c,a.dataType),$.isFunction(a.resultWrapper)&&(c=a.resultWrapper(c)),c.status="success"}catch(e){c=e,c.status="error",d="error"}"success"===d?($.isFunction(a.afterSuccess)&&a.afterSuccess.call(a.scope,a,c,d),$.isFunction(a.success)&&a.success.call(a.scope,a,c,d)):(d="error",$.isFunction(a.failure)&&a.failure.call(a.scope,a,c,d)),$.isFunction(a.complete)&&a.complete.call(a.scope,a,d)}},f=function(a,b,c){var d=c.length,e=null;return 0==d?e=a[b]():1==d?e=a[b](c[0]):2==d?e=a[b](c[0],c[1]):3==d?e=a[b](c[0],c[1],c[2]):4==d&&(e=a[b](c[0],c[1],c[2],c[3])),e},g=function(b){var c=a[b.external];c||(c=external.createObject(b.external),a[b.external]=c);var d=[];b.parameter&&($.isArray(b.parameter)?d=b.parameter:d[0]=b.parameter),b.callName&&e(b,d[0]),$.isEmptyObject(b.beforeUrl)||(logger.log("调用前置beforeUrl："+b.external+"."+b.beforeUrl),f(c,b.beforeUrl,d)),logger.log("调用url："+b.external+"."+b.url);var g=f(c,b.url,d);return g},h=function(a){},i=function(a){var b={};return b.type=a.type,b.dataType=a.dataType,b.callName=a.callName,b.failure=a.failure,b.complete=a.complete,b.resultWrapper=a.resultWrapper,b.scope=a.scope,$.isFunction(b.resultWrapper)||(b.resultWrapper=function(a){return $.isEmptyObject(a)?{}:(a.data=a.result,a.result={},a)}),b},j=function(b){var c=a[b.external];c||(c=external.createObject(b.external),a[b.external]=c);var d=b.url||"";"&"==d[d.length-1]&&(d=d.substr(0,d.length-1));var f=[],g=null;"GET"==b.type?($.each(b.parameter,function(a,b){f.push(a,"=",b,"&")}),f.length&&f.pop(),d.indexOf("?")<0&&f.length>0&&f.unshift("?"),d+=f.join("")):"POST"==b.type&&($.each(b.parameter,function(a,b){$.isEmptyObject(b)||f.push(a,"=",b,"&")}),f.length&&f.pop(),g=f.join("")),b.callName="onready",e(b,b),logger.log("hexinAjax请求发送：("+d+"), 参数("+g+")");var h=c.request({onready:b[b.callName],url:d,type:49,post:g});return h};Protocol.registerRequest("hexinAjax",{type:"hexinAjax",getOptions:i,validateOptions:h,request:j,registerEvent:null}),Protocol.registerRequest("client",{type:"client",getOptions:d,validateOptions:c,request:g,registerEvent:null})}();